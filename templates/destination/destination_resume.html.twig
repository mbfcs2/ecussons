{% extends 'destination/destination_base.html.twig' %}

{% block body %}

	<div class="columns">
		<div class="column {% if children is defined and children is not empty %}is-three-quarters-desktop is-full-tablet is-full-mobile{% endif %}">

			{% include 'site/includes/barreTitre.html.twig' with {'title': 'Ecussons ' ~ destination.name, 'pulledRight': destination.items.count ~ ' écussons'} %}
			{% if destination.items is empty %}
				{% include 'site/includes/blocContent.html.twig' with {'content': 'Aucun écusson pour cette destination.'} %}
			{% endif %}
			<div class="columns is-multiline is-mobile">
				{% for item_under in destination.items|slice(0,4) %}
					<div class="column is-half-mobile is-half-tablet is-one-quarter-desktop is-one-quarter-widescreen is-one-quarter-fullhd">
						<a href="{{ path('item_show', {'id': item_under.id}) }}">
							<div style="background-color:white;height:100%;box-shadow: 0px 0px 5px 2px rgba(0, 0, 0, .1);">
								<div style="height:70px; padding:10px;overflow:hidden;line-height:20px;background-color:moccasin;text-align:center;display:flex;align-items:center;justify-content:center">
									<p>
										<span><b>{{ item_under.destination.name }}</b></span><br />
										<span style="font-size:0.7em">{{ item_under.destination.parent.name }}</span>
									</p>
								</div>
								<div style="height:300px; background-color:white;position:relative;display:flex;align-items:center;justify-content:center">
									{% if item_under.getMainIllustration %}
										<img src="{{ vich_uploader_asset(item_under.getMainIllustration, 'imageFile') }}" style='max-width:100%;max-height:100%;'>
									{% else %}
										<p><i>Pas d'illustration</i></p>
									{% endif %}
								</div>
								<div style="height:70px; padding:10px;overflow:hidden;line-height:20px;background-color:#eeeeee;text-align:center;display:flex;align-items:center;justify-content:center">
									<span>{{ item_under.designation }}</span>
								</div>
							</div>
						</a>
					</div>
				{% endfor %}
				{% if destination.items|length > 4 %}
					<div class="column is-full">
						<a href="{{ path('destination_items', {'slug': destination.slug}) }}" class="is-pulled-right button is-primary m-t-sm">> Tous les écussons {{ destination.name }}</a>
					</div>
				{% endif %}
			</div>

			{% if children is defined %}
				{% include 'site/includes/barreTitre.html.twig' with {'title': 'Ecussons dans '~ destination.name , 'pulledRight': items_under|length ~ ' écussons'} %}
				{% if items_under is empty %}
					{% include 'site/includes/blocContent.html.twig' with {'content': 'Aucun écusson pour les destinations rattachées.'} %}
				{% else %}
					<div class="columns is-multiline is-mobile">
						{% for item_under in items_under|slice(0, 4) %}
							<div class="column is-half-mobile is-half-tablet is-one-quarter-desktop is-one-quarter-widescreen is-one-quarter-fullhd">
								<a href="{{ path('item_show', {'id': item_under.id}) }}">
									<div style="background-color:white;height:100%;box-shadow: 0px 0px 5px 2px rgba(0, 0, 0, .1);">
										<div style="height:70px; padding:10px;overflow:hidden;line-height:20px;background-color:moccasin;text-align:center;display:flex;align-items:center;justify-content:center">
											<p>
												<span><b>{{ item_under.destination.name }}</b></span><br />
												<span style="font-size:0.7em">{{ item_under.destination.parent.name }}</span>
											</p>
										</div>
										<div style="height:300px; background-color:white;position:relative;display:flex;align-items:center;justify-content:center">
											{% if item_under.getMainIllustration %}
												<img src="{{ vich_uploader_asset(item_under.getMainIllustration, 'imageFile') }}" style='max-width:100%;max-height:100%;'>
											{% else %}
												<p><i>Pas d'illustration</i></p>
											{% endif %}
										</div>
										<div style="height:70px; padding:10px;overflow:hidden;line-height:20px;background-color:#eeeeee;text-align:center;display:flex;align-items:center;justify-content:center">
											<span>{{ item_under.designation }}</span>
										</div>
									</div>
								</a>
							</div>
						{% endfor %}
						{% if items_under|length > 4 %}
							<div class="column is-full">
								<a href="{{ path('destination_items_under', {'slug': destination.slug}) }}" class="is-pulled-right button is-primary m-t-sm">> Tous les écussons</a>
							</div>
						{% endif %}
					</div>
				{% endif %}
			{% endif %}
		</div>
		{% if children is defined and children is not empty %}
			<div class="column is-one-quarter-desktop is-full-tablet is-full-mobile">
				{% include 'site/includes/barreTitre.html.twig' with {'title': 'Principales destinations'} %}
				<div class="columns is-multiline">
					<div class="column is-full">
						<ul>
						{% for child in dest_under %}
							<li><a href="{{ path('destination_list', {'slug': child.slug}) }}">{{ child.name }}</a></li>
						{% endfor %}
						</ul>
					</div>
					{% if children|length > 30 %}
						<div class="column is-full">
							<a href="{{ path('destination_dest_under', {'slug': destination.slug}) }}" class="is-pulled-right button is-primary m-t-sm">> Toutes les destinations</a>
						</div>
					{% endif %}
				</div>
			</div>
		{% endif %}
	</div>

{% endblock %}
